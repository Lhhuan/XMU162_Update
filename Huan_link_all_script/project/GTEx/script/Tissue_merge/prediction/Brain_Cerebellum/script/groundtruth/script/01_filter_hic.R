library(Rcpp)
library(readxl)
library(dplyr)
library(stringr)
library(ggpubr)
library(gridExtra)
library(data.table)
library(R.utils)
# library(Seurat)
# library(clusterProfiler)
# library(org.Hs.eg.db)
library(readr)
# library(EnsDb.Hsapiens.v79)
library(parallel)

setwd("/home/huanhuan/project/GTEx/script/Tissue_merge/prediction/Brain_Cerebellum/script/groundtruth/output/")
# org <- read_tsv("03_smiliarity.txt",col_names =T)%>%as.data.frame()
org <- fread("/home/huanhuan/project/GTEx/script/Tissue_merge/prediction/Brain_Cerebellum/output/06_Hi_C_result_chr1.bed.gz",header =F,sep="\t")%>%as.data.frame()
colnames(org) <-c("segment1_chr","segment1_start","segment1_end","segment2_chr","segment2_start","segment2_end","value")

quantile(org$value)
#top 75%
ff <-filter(org,value >8.3240571)
write.table(ff,"01_Hi_C_result_chr1_top25.bed",row.names=F,col.names=F,quote=F,sep="\t")
gzip("01_Hi_C_result_chr1_top25.bed")